alias be='bundle exec'
alias e-nz='export AGW_region=nz'
alias e-us='export AGW_region=us'
alias e-au='export AGW_region=au'
alias ws='cd ~/workspace/website'
alias gs='git status'
alias gd='git diff'
alias gds='git diff --staged'
alias gdd='git diff --color-words=.'
alias gl='git log'
alias gl-pretty='git log --pretty=format:"%h %ad | %s%d [%an]" --graph --date=short'
alias gb-recent='for ref in $(git for-each-ref --sort=-committerdate --format="%(refname)" refs/heads/ refs/remotes ); do git log -n1 $ref --pretty=format:"%Cgreen%cr%Creset %C(yellow)%d%Creset %C(bold blue)<%an>%Creset%n" | cat ; done | awk '"'! a["'$0'"]++'"
alias clear-rerere='rm -rf .git/rr-cache'
alias la='ls -al'

# https://blog.phusion.nl/2017/10/13/why-ruby-app-servers-break-on-macos-high-sierra-and-what-can-be-done-about-it/
alias unc='OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES bundle exec unicorn -p 3000 -c $HOME/.unicornrc'
alias unc_applog='{ tail -f log/development.log & OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES bundle exec unicorn -p 3000 -c $HOME/.unicornrc; }'

alias brs='bundle exec rails s'
alias brc='bundle exec rails c'
alias ssh-au='ssh agw-jb-ap-southeast-2'
alias ssh-us='ssh agw-jb-us-east-1'
alias ssh-match-test='/usr/local/bin/ssh -J ubuntu@oss1-dev -i ~/.ssh/agworld-dev-syd.pem ec2-user@$(aws --region=ap-southeast-2 ec2 describe-instances --filters "Name=tag:Name,Values=matchbook-release-env" --output text --query "Reservations[*].Instances[*].NetworkInterfaces[*].PrivateIpAddresses[*].PrivateIpAddress")'
alias ssh-unify-test='/usr/local/bin/ssh -J ubuntu@oss1-dev -i ~/.ssh/agworld-dev-syd.pem ec2-user@$(aws --region=ap-southeast-2 ec2 describe-instances --filters "Name=tag:Name,Values=unify-env" --output text --query "Reservations[*].Instances[*].NetworkInterfaces[*].PrivateIpAddresses[*].PrivateIpAddress")'
alias ssh-geo-us-test='/usr/local/bin/ssh -J ubuntu@oss1-dev -i ~/.ssh/agworld-dev-syd.pem ubuntu@$(aws --region=ap-southeast-2 ec2 describe-instances --filters "Name=tag:Name,Values=release-us-geoserver-asg" --output text --query "Reservations[*].Instances[*].NetworkInterfaces[*].PrivateIpAddresses[*].PrivateIpAddress")'
alias ssh-geo-au-test='/usr/local/bin/ssh -J ubuntu@oss1-dev -i ~/.ssh/agworld-dev-syd.pem ubuntu@$(aws --region=ap-southeast-2 ec2 describe-instances --filters "Name=tag:Name,Values=release-au-geoserver-asg" --output text --query "Reservations[*].Instances[*].NetworkInterfaces[*].PrivateIpAddresses[*].PrivateIpAddress")'
alias dbtest='dropdb agworld_test; DISABLE_DATABASE_ENVIRONMENT_CHECK=1 RAILS_ENV=test bundle exec rake db:setup --trace'
alias dbtestpd='dropdb pipe_dream_test; RAILS_ENV=test bundle exec rake db:test:prepare'
alias rspc='RAILS_ENV=test NO_COVERAGE=true bundle exec rspec --tag focus --format documentation -c'
alias psg='ps -ef | grep'
alias pgsizes='echo '\''select t1.datname AS db_name, pg_size_pretty(pg_database_size(t1.datname)) as db_size from pg_database t1 order by pg_database_size(t1.datname) desc;'\'' | psql'
alias policeme='git status --porcelain | cut -c4- | grep '\''.rb'\'' | xargs bundle exec rubocop'
alias servers='cat ~/.ssh/config | grep "Host " | head -n 9'
alias allservers='cat ~/.ssh/config | grep "Host "'
alias geostart='$GEOSERVER_HOME/bin/startup.sh'
alias geostop='$GEOSERVER_HOME/bin/shutdown.sh'
